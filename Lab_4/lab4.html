<!DOCTYPE html>
<html>
	<head>
		<!-- the mapbox libraries -->
		<script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.50.0/mapbox-gl.js'></script>
		<link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.50.0/mapbox-gl.css' rel='stylesheet' />
	</head>

	<body>
		<!-- the div for the map -->
		<!-- note the style is in-line, we have been putting it in the header. Outcome is the same -->
		<div id='map' style='width: 800px; height: 800px;'></div>
		<!-- the script that controls the map -->
		<script>
			//my Mapbox token
			mapboxgl.accessToken = 'pk.eyJ1IjoibmtlcnIwODAzIiwiYSI6ImNqZ2NzajFzcjJ3cncyeHQ1cHNwdWcycnEifQ.UiE1-IaevC2KYyN63XDQxw';
			
			//The map variable, set initial style, center/zoom
			var map = new mapboxgl.Map({
			    container: 'map',
			    style: 'mapbox://styles/nkerr0803/cjo6js2by1jg82rob4xvy1zkk', // stylesheet location
			    center: [-74.50, 40], // starting position [lng, lat]
			    zoom: 1 // starting zoom
			});
			//on map load, do some stuff
			map.on('load', function(){
				//add a source layer for earthquakes
				map.addSource('earthquakes', {
			        "type": "geojson",
			        "data": "https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_week.geojson"
			    });
			    //add the earthquakes to the map
			    map.addLayer({
			    	"id":"equakes",
			    	"type":"circle",
			    	"source":"earthquakes"
			    });

				//add a handler for clicking/popups 
				//Thanks to: https://www.mapbox.com/mapbox-gl-js/example/popup-on-click/ 
				map.on('click', 'equakes', function (e) {
			        var coordinates = e.features[0].geometry.coordinates.slice();
			        var description = e.features[0].properties.mag;

			        // Ensure that if the map is zoomed out such that multiple
			        // copies of the feature are visible, the popup appears
			        // over the copy being pointed to.
			        while (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {
			            coordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360;
			        }
			        //make the popup
			        new mapboxgl.Popup()
			            .setLngLat(coordinates)
			            .setHTML(description)
			            .addTo(map);

			    });
			});
		</script>
	</body>
</html>
		</script>
	</body>
</html>